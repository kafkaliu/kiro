# 变更管理

<!-- 导航元数据 -->
<!-- 章节：流程 | 级别：高级 | 先决条件：requirements-phase.md, design-phase.md -->
<!-- 相关：execution/implementation-guide.md, templates/checklists.md -->

**📍 您的位置：** [主指南](../../README.md) → [流程指南](README.md) → **变更管理**

## 快速导航
- **先决条件：** [需求阶段](requirements-phase.md), [设计阶段](design-phase.md)
- **模板：** [变更请求模板](../templates/change-request-template.md)
- **示例：** [变更管理示例](../examples/change-management-examples.md)

---

在实施过程中管理规范演进和处理发现的需求。

## 概述

规范是随着理解的加深而演变的活文档。本指南涵盖了在保持可追溯性和质量的同时管理变更的策略。

## 变更类型

### 1. 澄清性变更
- **内容：** 不影响范围的微小澄清
- **示例：** 拼写错误修复、格式改进、更清晰的措辞
- **流程：** 直接编辑，并在提交消息中注明澄清

### 2. 范围变更
- **内容：** 新的需求或修改现有需求
- **示例：** 额外的用户故事、更改的业务规则
- **流程：** 需要进行全面的变更影响评估

### 3. 实施发现
- **内容：** 编码期间发现的技术约束
- **示例：** API 限制、性能瓶颈、安全要求
- **流程：** 更新设计阶段，可能还包括需求

## 变更决策框架

```mermaid
flowchart TD
    A[变更请求] --> B{变更类型?}
    B -->|澄清| C[直接编辑]
    B -->|范围变更| D[影响评估]
    B -->|实施发现| E[技术审查]
    
    D --> F{影响 > 20% 工作量?}
    F -->|是| G[利益相关者批准]
    F -->|否| H[更新规范]
    
    E --> I{影响需求?}
    I -->|是| J[更新需求]
    I -->|否| K[仅更新设计]
    
    G --> L[主要版本更新]
    H --> M[次要版本更新]
    J --> N[需求审查]
    K --> O[设计审查]
```

## 版本控制策略

### 规范的语义化版本控制
- **主要 (1.0.0 → 2.0.0):** 对需求或核心设计的破坏性变更
- **次要 (1.0.0 → 1.1.0):** 新的需求或重大的设计变更
- **补丁 (1.0.0 → 1.0.1):** 澄清、错误修复、微小更新

### 分支策略
```
main/
├── spec-v1.0/          # 稳定的规范版本
├── feature/new-req     # 新需求分支
└── fix/clarification   # 微小修复分支
```

## 变更影响评估

### 要问的问题
1. **需求影响**
   - 这是否会改变现有的用户故事？
   - 是否需要新的验收标准？
   - 是否有任何需求变得过时？

2. **设计影响**
   - 哪些组件受到影响？
   - 是否引入了新的依赖关系？
   - 架构是否需要修订？

3. **实施影响**
   - 有多少任务需要更新？
   - 估算的工作量变化是多少？
   - 是否存在新的风险或障碍？

### 影响评分
- **低 (1-2 分):** 澄清、微小补充
- **中 (3-5 分):** 新功能、中度设计变更
- **高 (6-8 分):** 重大范围变更、架构修订
- **关键 (9-10 分):** 基本需求变更

## 变更工作流

### 1. 创建变更请求
```markdown
## 变更请求：[简要描述]

**类型：** [澄清/范围/实施发现]
**请求者：** [姓名/角色]
**日期：** [YYYY-MM-DD]

### 当前状态
[现在存在什么]

### 建议的变更
[应该改变什么]

### 理由
[为什么需要此变更]

### 影响评估
- 需求：[无/微小/重大]
- 设计：[无/微小/重大]
- 实施：[无/微小/重大]
- 工作量变更：[+/- X 小时/天]

### 需要批准
- [ ] 产品负责人 (针对范围变更)
- [ ] 技术负责人 (针对设计变更)
- [ ] 利益相关者 (针对重大变更)
```

### 2. 审查流程
1. **技术审查：** 评估实施可行性
2. **业务审查：** 验证业务价值和优先级
3. **影响分析：** 计算工作量和时间表变更
4. **批准决策：** 根据影响和价值决定是否进行

### 3. 实施
1. **更新规范：** 修改受影响的部分
2. **版本升级：** 根据变更类型更新版本
3. **可追溯性：** 将变更链接到原始需求
4. **沟通：** 将变更通知利益相关者

## 处理实施发现

### 常见的发现类型
1. **技术约束**
   - 第三方 API 限制
   - 性能要求
   - 安全考虑

2. **集成挑战**
   - 数据格式不匹配
   - 认证复杂性
   - 时间依赖性

3. **用户体验问题**
   - 可访问性要求
   - 移动响应性
   - 浏览器兼容性

### 发现响应流程
1. **记录发现：** 记录发现了什么以及为什么它很重要
2. **评估选项：** 列出可能的解决方案和权衡
3. **更新规范：** 根据需要修改设计或需求
4. **验证变更：** 确保变更与原始目标一致

## 活规范实践

### 定期审查周期
- **每周：** 检查实施发现
- **冲刺结束：** 对照规范审查已完成的任务
- **每月：** 评估整体规范的健康状况和准确性

### 规范健康指标
- **准确性：** 与实施匹配的需求百分比
- **完整性：** 规范覆盖的实施百分比
- **时效性：** 自上次有意义更新以来的天数
- **可追溯性：** 链接到规范项的代码更改百分比

### 维护指南
1. **保持最新：** 随着实施的进展更新规范
2. **保持可追溯性：** 将所有变更追溯到需求
3. **记录决策：** 记录进行变更的原因
4. **沟通变更：** 保持利益相关者知情

## 变更沟通

### 利益相关者通知
```markdown
## 规范变更通知

**规范：** [规范名称 v1.2.0]
**变更类型：** [次要/主要]
**日期：** [YYYY-MM-DD]

### 摘要
[变更的简要描述]

### 影响
- 时间表：[无变更/+X 天]
- 范围：[无变更/添加/删除功能]
- 资源：[无变更/+X 小时]

### 需要采取的行动
- [ ] 审查更新的需求
- [ ] 批准设计变更
- [ ] 更新项目时间表

### 问题/疑虑
联系人：[姓名] [电子邮件]
```

## 工具和集成

### 版本控制集成
- 使用 Git 标签作为规范版本
- 将提交链接到变更请求
- 在规范存储库中维护变更日志

### 项目管理集成
- 根据变更更新任务估算
- 为变更驱动的工作创建新工单
- 将变更链接到原始用户故事

### 文档集成
- 自动生成变更日志
- 更新 API 文档
- 与项目维基同步

---

## 🔗 相关内容

### 先决条件
- [需求阶段](requirements-phase.md) - 变更管理的基础
- [设计阶段](design-phase.md) - 理解设计演进

### 模板
- [变更请求模板](../templates/change-request-template.md)
- [影响评估清单](../templates/checklists.md#change-impact)

### 示例
- [变更管理案例研究](../examples/change-management-examples.md)

[← 返回流程指南](README.md) | [实施指南 →](../execution/implementation-guide.md)