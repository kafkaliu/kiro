# 提示最佳实践

<!-- 导航元数据 -->
<!-- 提示：最佳实践 | 级别：实践指南 | 先决条件：prompting/strategies.md -->
<!-- 相关：ai-reasoning/decision-frameworks.md, examples/troubleshooting-pitfalls.md, templates/README.md -->

**📍 您的位置：** [主指南](../../README.md) → [提示策略](README.md) → **最佳实践**

## 快速导航
- **📚 学习策略：** [提示策略](strategies.md) - 首先是核心方法
- **📝 使用模板：** [提示模板](templates.md) - 即用型模式
- **🧠 理解 AI：** [决策框架](../ai-reasoning/decision-frameworks.md) - AI 如何做决策
- **🔧 解决问题：** [故障排除指南](../examples/troubleshooting-pitfalls.md) - 当提示出错时

---

在规范创建过程中进行 AI 协作的有效技术，包括故障排除指南和成功交互的示例。

## 核心原则

### 1. 背景为王

**提供丰富的背景**
- 始终包括有关您的项目、技术栈和约束的相关背景
- 引用以前的讨论和决策以保持连续性
- 解释您的需求背后的“为什么”，而不仅仅是“什么”

**示例 - 良好的背景设置：**
```
我正在开发一个 React 电子商务应用程序，目前每天处理 1 万用户。
我们使用 TypeScript、Node.js 后端和 PostgreSQL，并部署在 AWS 上。
我需要添加一个产品推荐功能，该功能与我们现有的
用户行为跟踪系统集成，并应能处理我们预期的 50% 流量增长。
```

**示例 - 差的背景：**
```
我需要一个推荐系统。
```

### 2. 具体和明确

**使用具体示例**
- 提供具体场景而不是抽象描述
- 在讨论数据模型时包括实际数据示例
- 引用真实的用户工作流和业务流程

**示例 - 具体请求：**
```
对于用户认证系统，我需要处理以下具体场景：
1. 带电子邮件验证的新用户注册
2. 通过 Google 和 GitHub OAuth 进行社交登录
3. 带有安全令牌过期（24 小时）的密码重置
4. 5 次失败尝试后账户锁定，冷却时间为 30 分钟
5. 与我们现有的存储偏好的用户个人资料系统集成
```

### 3. 结构化复杂请求

**分解大型请求**
- 将复杂功能划分为逻辑阶段
- 优先考虑核心功能，而不是可有可无的功能
- 对请求进行排序以逐步建立理解

**示例 - 结构良好的请求：**
```
我想为文件上传系统创建一个全面的规范。让我们从以下开始：

阶段1：核心上传功能
- 单文件上传与进度跟踪
- 文件类型验证（图像、文档）
- 大小限制（最大 10MB）

阶段2：增强功能（我们将在阶段1稳固后再处理）
- 多文件上传
- 拖放界面
- 云存储集成
```

## 特定阶段的最佳实践

### 需求阶段

**要做：**
- 从用户问题开始，而不是技术解决方案
- 一致地使用“作为 [角色]，我希望 [目标]，以便 [好处]”的格式
- 包括愉快路径和错误场景
- 指定可衡量的验收标准

**不要做：**
- 直接进入实施细节
- 假设 AI 了解您的业务背景
- 创建过于宽泛或模糊的需求
- 跳过边缘案例和错误处理

**成功交互示例：**
```
用户：“我需要为我的应用提供用户认证。”

更好的方法：“我正在为小企业构建一个 SaaS 应用程序。
我需要支持以下的用户认证：
- 需要管理团队访问权限的企业主
- 具有不同权限级别的团队成员
- 与现有客户数据集成
- 符合 SOC 2 要求

主要的用户故事是：作为企业主，我希望控制谁可以
访问我们公司的据，以便我能维护安全和合规性。”
```

### 设计阶段

**要做：**
- 在做设计决策时引用具体需求
- 解释不同方法之间的权衡
- 从一开始就考虑可扩展性和可维护性
- 在设计中包括错误处理和边缘案例

**不要做：**
- 脱离需求进行设计
- 为假设的未来需求过度设计
- 忽略现有系统约束
- 跳过非功能性需求

**成功交互示例：**
```
用户：“根据我们的认证需求，我需要一个
处理我们讨论过的多租户访问控制的设计。我们当前的系统
使用 JWT 令牌，我们大约有 500 家企业，平均每家
8 个团队成员。性能至关重要 - 登录应在 200 毫秒以下。

请设计一种方法，该方法：
1. 利用我们现有的 JWT 基础设施
2. 扩展到我们当前的用户群
3. 支持需求 2.3 中的基于角色的权限
4. 与我们的 PostgreSQL 用户数据库集成”
```

### 任务阶段

**要做：**
- 请求增量构建的任务
- 为每个任务指定测试要求
- 要求可以独立完成的任务
- 包括集成和部署考虑

**不要做：**
- 创建太大或太复杂的任务
- 跳过测试和验证步骤
- 忽略任务之间的依赖关系
- 忘记文档和清理

**成功交互示例：**
```
用户：“请将认证设计分解为编码任务。
我想遵循 TDD 原则并能够增量部署。
每个任务应在 2-4 小时内完成，并包括其自己的测试。

优先事项是首先让基本的登录/登出工作，然后添加
基于角色的权限。我正在使用 Jest 进行测试，并已
使用 GitHub Actions 设置了 CI/CD。”
```

## 沟通技巧

### 迭代求精

**在先前响应的基础上构建**
```
“总体而言，需求看起来不错。我想优化需求 2.1
以更具体地说明错误处理。与其说‘系统应
优雅地处理错误’，不如让我们确切地指定当
认证失败、网络不可用和令牌过期时会发生什么。”
```

**验证理解**
```
“在我们进入设计之前，让我确认一下我的理解：
- 我们优先考虑安全性而不是便利性
- 与现有系统的集成是强制性的，而不是可选的
- 性能要求是确定的（登录时间低于 200 毫秒）
- 我们需要支持 Web 和移动客户端
这样对吗？”
```

### 反馈整合

**具体的变更请求**
```
“我需要对设计进行以下具体更改：
1. 将 Redis 缓存替换为内存缓存以降低基础设施复杂性
2. 添加速率限制以防止暴力破解攻击（需求 1.4）
3. 为移动应用用例包括会话管理
4. 指定角色存储所需的数据库模式更改”
```

**解释理由**
```
“我想将认证方法从 OAuth 更改为 JWT，因为：
- 我们的团队在 JWT 实施方面有更多经验
- 它减少了外部依赖（不需要 OAuth 提供商）
- 更适合我们具有离线功能的移动应用需求
- 在我们当前的设置中测试和调试更简单”
```

## 常见问题故障排除

### 当响应过于笼统时

**问题：** AI 提供高级、通用的建议，而不是具体的指导。

**解决方案：** 添加更多背景和约束。

**之前：**
```
“我应该如何为用户管理构建我的数据库？”
```

**之后：**
```
“我有一个用于多租户 SaaS 应用的 PostgreSQL 数据库，具有以下约束：
- 500 家企业，平均每家 8 个用户
- 需要跟踪用户角色、权限和活动
- 当前用户表有 id、email、created_at
- 必须保持与现有认证系统的向后兼容性
- 性能目标：用户查找时间低于 50 毫秒

我应该如何扩展模式以支持基于角色的访问控制？”
```

### 当需求不断变化时

**问题：** 需求阶段的范围蔓延。

**解决方案：** 建立清晰的边界和优先级。

**方法：**
```
“让我们首先确定 MVP 范围。对于版本1，我们必须有：
- [核心需求1]
- [核心需求2]
- [核心需求3]

未来版本的好功能：
- [增强功能1]
- [增强功能2]

请仅将需求集中在 MVP 范围内。”
```

### 当设计变得过于复杂时

**问题：** 设计试图解决所有可能的未来需求。

**解决方案：** 重新关注当前的需求和约束。

**方法：**
```
“设计变得复杂了。让我们通过仅关注
需求 1.1-1.4 来简化。我们稍后可以为需求
2.x 扩展它。请修订设计以：
- 处理当前用户负载（而不是 10 倍的未来增长）
- 使用我们现有的技术栈（不要引入新技术）
- 解决我们需求中的具体问题（而不是一般问题）”
```

### 当任务过于抽象时

**问题：** 实施任务对于实际编码来说过于高级。

**解决方案：** 请求具体的、可操作的编码步骤。

**之前：**
```
“- 实施用户认证系统”
```

**之后：**
```
“请将‘实施用户认证系统’分解为具体的编码任务，例如：
- 创建带有 email、password_hash、role 字段的用户模型
- 使用 bcrypt 编写密码哈希实用函数
- 实施验证凭据并返回 JWT 的登录端点
- 创建中间件以验证受保护路由上的 JWT 令牌
- 为每个组件编写单元测试”
```

## 质量验证技术

### 需求验证

**完整性检查：**
```
“请审查这些需求并找出任何差距：
- 是否涵盖了所有用户类型？
- 我们是否处理了所有错误场景？
- 是否指定了集成点？
- 性能要求是否可衡量？
- 范围是否明确界定？”
```

**EARS 格式验证：**
```
“请检查这些验收标准是否正确遵循 EARS 格式：
- 它们是否以 WHEN、IF、WHERE、WHILE 开头？
- 系统响应是否用 SHALL 明确指定？
- 条件和触发器是否具体且可测试？”
```

### 设计验证

**架构审查：**
```
“请对照我们的需求验证此设计：
- 它是否解决了所有功能性需求？
- 是否处理了非功能性需求（性能、安全）？
- 组件之间的接口是否定义明确？
- 错误处理策略是否全面？
- 这可以有效地测试吗？”
```

**技术可行性：**
```
“考虑到我们的约束（团队规模、时间表、现有系统），
这个设计是否现实？是否有任何部分看起来
过度设计或规范不足？”
```

### 任务验证

**可操作性检查：**
```
“这些任务对于开发人员来说是否足够具体以进行实施？
- 它们是否指定了要创建的确切文件/组件？
- 任务之间的依赖关系是否清晰？
- 每个任务是否可以独立完成和测试？
- 它们是否逐步构建以实现完整功能？”
```

## 高级技术

### 研究整合

**当您需要技术研究时：**
```
“在我们最终确定设计之前，我需要研究
多租户 SaaS 应用程序的认证最佳实践。请帮助我
确定要研究的关键领域：
- 基于角色的访问控制的行业标准
- 常见的安全漏洞和缓解措施
- 大规模 JWT 的性能优化技术
- 与现有系统的集成模式”
```

### 约束管理

**处理冲突的需求：**
```
“我们有冲突的需求：用户希望单点登录（需求 1.3）
但我们还需要离线功能（需求 2.1）。请帮助我：
1. 分析这些方法之间的权衡
2. 建议折衷方案
3. 推荐哪个需求应优先考虑以及为什么”
```

### 利益相关者对齐

**多角度验证：**
```
“请从不同的利益相关者角度审查这些需求：
- 开发人员：它们在我们的技术栈中技术上是否可行？
- 用户：它们是否有效地解决了真实的用户问题？
- 业务：它们是否符合我们的业务目标和约束？
- 安全：是否存在任何安全问题或差距？”
```

---

[← 模板](templates.md) | [返回提示指南](README.md)