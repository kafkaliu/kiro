# 轻量级规范

<!-- 导航元数据 -->
<!-- 章节：方法论 | 级别：实践 | 先决条件：when-to-use.md -->
<!-- 相关：templates/quick-spec-template.md, examples/lightweight-examples.md -->

**📍 您的位置：** [主指南](../../README.md) → [方法论](README.md) → **轻量级规范**

## 快速导航
- **先决条件：** [何时使用规范](when-to-use.md)
- **模板：** [快速规范模板](../templates/quick-spec-template.md)
- **示例：** [轻量级示例](../examples/lightweight-examples.md)

---

针对小功能、错误修复和快速迭代的简化规范流程。

## 概述

并非每个更改都需要一个完整的三阶段规范。本指南帮助您根据复杂性、风险和影响选择适当的规范级别。

## 规范复杂性决策树

```mermaid
flowchart TD
    A[新工作项] --> B{工作量 > 1 天?}
    B -->|否| C[微型规范]
    B -->|是| D{多个组件?}
    
    D -->|否| E{新模式/技术?}
    E -->|否| F[快速规范]
    E -->|是| G[标准规范]
    
    D -->|是| H{跨团队影响?}
    H -->|否| I[标准规范]
    H -->|是| J[完整规范]
    
    C --> K[仅记录更改]
    F --> L[仅需求 + 任务]
    G --> M[所有阶段，简化版]
    I --> N[完整三阶段流程]
    J --> O[完整流程 + 利益相关者审查]
```

## 规范类型

### 1. 微型规范 (< 1 天工作量)
**用于：**
- 错误修复
- 文案更改
- 配置更新
- 轻微的 UI 调整

**格式：**
```markdown
# [简要描述]

**内容：** 一句话描述更改
**原因：** 简要理由
**方式：** 2-3 个实施步骤要点
**验收：** 简单的通过/失败标准
```

**示例：**
```markdown
# 修复登录按钮颜色

**内容：** 将登录按钮从蓝色更改为绿色以匹配品牌指南
**原因：** 设计团队的品牌一致性要求
**方式：** 
- 将 CSS 变量 `--primary-button-color` 更新为 `#28a745`
- 验证颜色是否符合可访问性对比度要求
**验收：** 登录按钮显示为绿色并通过 WCAG AA 对比度测试
```

### 2. 快速规范 (1-3 天工作量)
**用于：**
- 小功能
- API 端点添加
- 数据库模式更改
- 组件修改

**格式：**
- **需求：** 2-3 个简化格式的用户故事
- **任务：** 直接的实施步骤（跳过设计阶段）
- **验收：** 清晰的成功标准

**模板：**
```markdown
# [功能名称] - 快速规范

## 需求
**作为** [用户类型]
**我希望** [能力]
**以便** [好处]

**验收标准：**
- [ ] [具体的、可测试的标准]
- [ ] [另一个标准]

## 实施任务
1. [具体的编码任务，附估算时间]
2. [另一个任务]
3. [测试/验证任务]

## 完成定义
- [ ] 代码完成并审查
- [ ] 测试通过
- [ ] 验收标准已验证
```

### 3. 标准规范 (3-10 天工作量)
**用于：**
- 中等功能
- 新集成
- 性能改进
- 安全增强

**格式：**
- **需求：** 完整的 EARS 格式，但故事较少
- **设计：** 简化的架构概述
- **任务：** 详细的实施计划

### 4. 完整规范 (> 10 天工作量)
**用于：**
- 主要功能
- 系统重新设计
- 跨团队计划
- 高风险更改

**格式：** 主指南中描述的完整三阶段流程

## 轻量级需求格式

### 简化的用户故事
代替完整的 EARS 格式，使用：
```markdown
**故事：** 作为 [用户]，我希望 [目标]，以便 [好处]
**假设** [背景]
**当** [操作]
**那么** [结果]
```

### 验收标准快捷方式
- **愉快路径：** 正常情况下应该如何工作
- **边缘案例：** 1-2 个最可能的边缘案例
- **错误处理：** 如何处理失败

### 非功能性需求
快速清单格式：
- [ ] 性能：[具体要求]
- [ ] 安全性：[具体要求]
- [ ] 可访问性：[具体要求]
- [ ] 浏览器支持：[具体要求]

## 快速设计模式

### 组件更改
```markdown
## 设计概述
**现有：** [当前组件行为]
**更改：** [将会有什么不同]
**依赖关系：** [这会影响什么]
**风险：** [潜在问题]
```

### API 更改
```markdown
## API 设计
**端点：** [方法和路径]
**输入：** [请求格式]
**输出：** [响应格式]
**错误：** [错误响应]
```

### 数据库更改
```markdown
## 数据更改
**表：** [受影响的表]
**字段：** [新的/修改的字段]
**迁移：** [如何迁移现有数据]
**回滚：** [如果需要，如何撤销]
```

## 任务分解快捷方式

### 标准任务类别
1. **设置：** 环境、依赖项、配置
2. **核心逻辑：** 主要实施工作
3. **集成：** 与现有系统连接
4. **测试：** 单元测试、集成测试
5. **文档：** 代码注释、README 更新
6. **部署：** 发布准备

### 时间估算指南
- **简单 CRUD：** 每个端点 2-4 小时
- **UI 组件：** 每个组件 4-8 小时
- **集成：** 每个外部服务 1-2 天
- **测试：** 开发时间的 25-50%
- **文档：** 开发时间的 10-20%

## 轻量级规范的质量门禁

### 微型规范门禁
- [ ] 更改已明确描述
- [ ] 实施方法显而易见
- [ ] 成功标准已定义

### 快速规范门禁
- [ ] 用户价值已阐明
- [ ] 技术方法合理
- [ ] 工作量估算合理
- [ ] 依赖关系已确定

### 标准规范门禁
- [ ] 需求是可测试的
- [ ] 设计解决了所有需求
- [ ] 任务是可操作的并已估算
- [ ] 风险已确定并得到缓解

## 常见的轻量级模式

### 错误修复模式
```markdown
# 错误：[简要描述]

**问题：** [哪里坏了]
**根本原因：** [为什么坏了]
**修复：** [如何修复]
**测试：** [如何验证修复]
**风险：** [可能出什么问题]
```

### 功能开关模式
```markdown
# 功能：[名称] (在开关后面)

**开关：** `feature_[name]_enabled`
**默认：** `false`
**推出：** 逐步，从内部用户开始

**实施：**
- [ ] 添加功能开关
- [ ] 在开关后面实施功能
- [ ] 添加监控/指标
- [ ] 规划推出策略
```

### 配置更改模式
```markdown
# 配置：[描述]

**环境：** [哪些环境]
**值：** [哪些更改]
**影响：** [这会影响什么]
**回滚：** [如何撤销]
**验证：** [如何验证它是否有效]
```

## 何时升级规范复杂性

### 微型规范的危险信号
- 实施时间比预期的要长
- 需要更改多个文件
- 其他开发人员提出澄清问题
- 测试揭示了未考虑的边缘案例

### 快速规范的危险信号
- 在实施过程中出现设计问题
- 发现了对其他团队的依赖关系
- 性能影响变得明显
- 需要安全审查

### 升级流程
1. **暂停实施：** 当复杂性增加时停止编码
2. **评估差距：** 需要哪些额外的规范？
3. **升级规范：** 添加缺失的需求、设计或任务
4. **获取批准：** 与利益相关者审查升级后的规范
5. **恢复实施：** 继续使用更好的规范

## 工具和模板

### 数字模板
- **微型规范：** 单个 markdown 部分
- **快速规范：** GitHub 问题模板
- **标准规范：** 简化的三阶段模板

### 集成点
- **问题跟踪：** 将规范链接到工单
- **代码审查：** 在 PR 描述中引用规范
- **文档：** 从规范元数据自动生成

---

## 🔗 相关内容

### 先决条件
- [何时使用规范](when-to-use.md) - 规范的决策框架

### 模板
- [快速规范模板](../templates/quick-spec-template.md)
- [微型规范模板](../templates/micro-spec-template.md)

### 示例
- [轻量级规范示例](../examples/lightweight-examples.md)
- [规范升级示例](../examples/spec-upgrade-examples.md)

[← 返回方法论](README.md) | [流程指南 →](../process/README.md)